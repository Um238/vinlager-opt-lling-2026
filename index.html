<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#4A90E2">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Vinlager">
  <link rel="apple-touch-icon" href="icon-app.png">

  <title>CellarCount 2026 - Vinlager Optælling</title>

  <link rel="stylesheet" href="styles.css?v=33">
  <link rel="manifest" href="manifest-app.json">

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">

  <!-- Eksterne libs -->
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
</head>

<body>

<script>
  // PWA: register service worker
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./sw.js').catch(() => {});
    });
  }

  let deferredPrompt = null;
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
  });

  async function promptInstall() {
    if (!deferredPrompt) {
      alert('Install/genvej: Åbn browser-menuen og vælg "Tilføj til startskærm".');
      return;
    }
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
  }
  window.promptInstall = promptInstall;
</script>

<!-- LOGIN -->
<div id="login-screen" class="login-screen" style="display:flex;">
  <!-- login content uændret -->
</div>

<header id="main-header" style="display:none;">
  <!-- header uændret -->
</header>

<main id="main-content" style="display:none;">
  <!-- ALT INDHOLD UÆNDRET -->
</main>

<!-- Debug / cache clear -->
<script>
  const CACHE_VERSION = 'v26_' + Date.now();
  console.log('INDEX LOAD', CACHE_VERSION);

  if ('caches' in window) {
    caches.keys().then(names => {
      names.forEach(n => caches.delete(n));
    });
  }
</script>

<!-- ✅ RETTEDE SCRIPT TAGS -->
<script src="config.js?v=29" defer></script>
<script src="auth.js?v=28" defer></script>
<script src="app.js?v=108" defer></script>

<script>
  console.log('All scripts loaded');
</script>

</body>
</html>
